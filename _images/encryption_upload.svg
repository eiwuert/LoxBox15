<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/PR-SVG-20010719/DTD/svg10.dtd">
<svg width="33cm" height="34cm" viewBox="165 84 650 678" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <g>
    <rect style="fill: #ffffff" x="206.4" y="261.8" width="520" height="260"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="206.4" y="261.8" width="520" height="260"/>
  </g>
  <g>
    <rect style="fill: #ffffff" x="229.326" y="85.8" width="74.15" height="36"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="229.326" y="85.8" width="74.15" height="36"/>
    <text font-size="12.8" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="266.401" y="107.7">
      <tspan x="266.401" y="107.7">backend</tspan>
    </text>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke: #000000" x1="239.326" y1="110.7" x2="293.476" y2="110.7"/>
  </g>
  <g>
    <rect style="fill: #ffffff" x="549.326" y="85.8" width="55.15" height="36"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="549.326" y="85.8" width="55.15" height="36"/>
    <text font-size="12.8" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="576.901" y="107.7">
      <tspan x="576.901" y="107.7">client</tspan>
    </text>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke: #000000" x1="559.326" y1="110.7" x2="594.476" y2="110.7"/>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="266.4" y1="121.8" x2="266.4" y2="161.8"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="266.4" y1="241.8" x2="266.4" y2="461.8"/>
    <rect style="fill: #ffffff" x="259.4" y="161.8" width="14" height="80"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="259.4" y="161.8" width="14" height="80"/>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="576.9" y1="121.8" x2="576.9" y2="161.8"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="576.9" y1="241.8" x2="576.9" y2="325.8"/>
    <rect style="fill: #ffffff" x="569.9" y="161.8" width="14" height="80"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="569.9" y="161.8" width="14" height="80"/>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="290.4" y1="181.8" x2="569.9" y2="181.8"/>
    <polygon style="fill: #000000" points="290.4,176.8 274.4,181.8 290.4,186.8 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="290.4,176.8 274.4,181.8 290.4,186.8 "/>
    <text font-size="12.7998" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="421.65" y="191.8">get encrypted key, iv</text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="552.9" y1="221.8" x2="273.4" y2="221.8"/>
    <polygon style="fill: #000000" points="552.9,226.8 568.9,221.8 552.9,216.8 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="552.9,226.8 568.9,221.8 552.9,216.8 "/>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="576.9" y1="241.8" x2="576.9" y2="341.8"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="576.9" y1="401.8" x2="576.9" y2="571.8"/>
    <rect style="fill: #ffffff" x="569.9" y="341.8" width="14" height="60"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="569.9" y="341.8" width="14" height="60"/>
  </g>
  <g>
    <polyline style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="583.9,356.8 604.9,356.8 604.9,386.8 593.636,386.8 "/>
    <polygon style="fill: #000000" points="586.136,386.8 596.136,381.8 593.636,386.8 596.136,391.8 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="586.136,386.8 596.136,381.8 593.636,386.8 596.136,391.8 "/>
  </g>
  <g>
    <polygon style="fill: #ffffff" points="635.9,341.8 772.8,341.8 784.8,353.8 784.8,375.8 635.9,375.8 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="635.9,341.8 772.8,341.8 784.8,353.8 784.8,375.8 635.9,375.8 "/>
    <polyline style="fill: none; fill-opacity:0; stroke-width: 1; stroke: #000000" points="772.8,341.8 772.8,353.8 784.8,353.8 "/>
    <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:monospace;font-style:normal;font-weight:normal" x="642.9" y="366.7">
      <tspan x="642.9" y="366.7">key, iv = decrypt</tspan>
    </text>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="466.4" y="181.8">
    <tspan x="466.4" y="181.8"></tspan>
  </text>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="576.9" y1="401.8" x2="576.9" y2="561.8"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="576.9" y1="621.8" x2="576.9" y2="636.8"/>
    <rect style="fill: #ffffff" x="569.9" y="561.8" width="14" height="60"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="569.9" y="561.8" width="14" height="60"/>
  </g>
  <g>
    <polyline style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="583.9,576.8 604.9,576.8 604.9,606.8 593.636,606.8 "/>
    <polygon style="fill: #000000" points="586.136,606.8 596.136,601.8 593.636,606.8 596.136,611.8 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="586.136,606.8 596.136,601.8 593.636,606.8 596.136,611.8 "/>
  </g>
  <g>
    <polygon style="fill: #ffffff" points="626.4,561.8 794.1,561.8 806.1,573.8 806.1,595.8 626.4,595.8 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="626.4,561.8 794.1,561.8 806.1,573.8 806.1,595.8 626.4,595.8 "/>
    <polyline style="fill: none; fill-opacity:0; stroke-width: 1; stroke: #000000" points="794.1,561.8 794.1,573.8 806.1,573.8 "/>
    <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:monospace;font-style:normal;font-weight:normal" x="633.4" y="586.7">
      <tspan x="633.4" y="586.7">AES(CFB).encrypt_file</tspan>
    </text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="576.9" y1="621.8" x2="576.9" y2="661.8"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="576.9" y1="701.8" x2="576.9" y2="761.8"/>
    <rect style="fill: #ffffff" x="569.9" y="661.8" width="14" height="40"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="569.9" y="661.8" width="14" height="40"/>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="266.4" y1="441.8" x2="266.4" y2="661.8"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="266.4" y1="701.8" x2="266.4" y2="761.8"/>
    <rect style="fill: #ffffff" x="259.4" y="661.8" width="14" height="40"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="259.4" y="661.8" width="14" height="40"/>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="273.4" y1="681.8" x2="569.9" y2="681.8"/>
    <polyline style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="289.4,676.8 273.4,681.8 273.4,681.8 "/>
    <text font-size="12.7998" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="421.65" y="691.8">send encrypted file</text>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="280.676" y="602.8">
    <tspan x="280.676" y="602.8"></tspan>
  </text>
  <g>
    <polygon style="fill: #ffffff" points="206.4,261.8 235.5,261.8 247.5,273.8 247.5,295.8 206.4,295.8 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="206.4,261.8 235.5,261.8 247.5,273.8 247.5,295.8 206.4,295.8 "/>
    <polyline style="fill: none; fill-opacity:0; stroke-width: 1; stroke: #000000" points="235.5,261.8 235.5,273.8 247.5,273.8 "/>
    <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:monospace;font-style:normal;font-weight:normal" x="213.4" y="286.7">
      <tspan x="213.4" y="286.7">alt</tspan>
    </text>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="226.4" y="321.8">
    <tspan x="226.4" y="321.8">has_keys == TRUE</tspan>
  </text>
  <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke-dasharray: 20; stroke: #7f7f7f" x1="166.4" y1="421.8" x2="766.4" y2="421.8"/>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="576.9" y1="401.8" x2="576.9" y2="441.8"/>
    <line style="fill: none; fill-opacity:0; stroke-width: 1; stroke-dasharray: 8; stroke: #000000" x1="576.9" y1="481.8" x2="576.9" y2="561.8"/>
    <rect style="fill: #ffffff" x="569.9" y="441.8" width="14" height="40"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="569.9" y="441.8" width="14" height="40"/>
  </g>
  <g>
    <polyline style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="583.9,441.8 607.4,441.8 607.4,471.8 593.636,471.8 "/>
    <polygon style="fill: #000000" points="586.136,471.8 596.136,466.8 593.636,471.8 596.136,476.8 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="586.136,471.8 596.136,466.8 593.636,471.8 596.136,476.8 "/>
  </g>
  <g>
    <polygon style="fill: #ffffff" points="626.4,441.8 801.8,441.8 813.8,453.8 813.8,475.8 626.4,475.8 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="626.4,441.8 801.8,441.8 813.8,453.8 813.8,475.8 626.4,475.8 "/>
    <polyline style="fill: none; fill-opacity:0; stroke-width: 1; stroke: #000000" points="801.8,441.8 801.8,453.8 813.8,453.8 "/>
    <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:monospace;font-style:normal;font-weight:normal" x="633.4" y="466.7">
      <tspan x="633.4" y="466.7">key, iv = CryptoRandom</tspan>
    </text>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="226.4" y="441.8">
    <tspan x="226.4" y="441.8">else</tspan>
  </text>
</svg>
